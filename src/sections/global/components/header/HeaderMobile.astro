---
import CoberturaMobile from '@sections/global/components/header/cobertura/CoberturaMobile.astro';

//Items del header

const ITEMS = [
	{
		id: 1,
		name: 'Inicio',
		src: '/',
		target: false
	},
	{
		id: 2,
		name: 'Familia CJI',
		src: '/familiaCJI',
		target: false
	},
	{
		id: 3,
		name: 'Noticias',
		src: 'https://accolombianlawyers.com/noticias/',
		target: true
	},
	{
		id: 4,
		name: 'Actualidad Jurídica',
		src: 'https://actualidadjuridicaempresarial.com/',
		target: true
	},
	{
		id: 5,
		name: 'Diplomado',
		src: '/diplomado',
		target: false
	},
	{
		id: 6,
		name: 'Portafolio',
		src: '/portafolio',
		target: false
	},
	{
		id: 7,
		name: 'Seminarios Prácticos',
		src: 'https://seminariojuridico.com/',
		target: true
	},
	{
		id: 8,
		name: 'Ingreso Funcionarios',
		src: '/funcionarios/funcionarios2',
		target: false
	}
];
---

<div
	id="navHeaderMobile"
	class="animate-fadeIn-header bg-theme-green-main z-600 hidden h-screen w-full items-center justify-center overflow-y-hidden"
>
	<ul
		class="mx-8 -mt-40 flex h-full flex-col items-center justify-center gap-x-6 gap-y-3 text-white"
	>
		<hr />
		<!-- Esto renderiza los items del header -->
                {
                        ITEMS.map((item) => {
                                const target = item.target ? '_blank' : '_self';
                                const rel = item.target ? 'noopener noreferrer' : undefined;
                                const isInternal = !item.target && item.src.startsWith('/');

                                return (
                                        <li
                                                key={`header-mobile-${item.id}`}
                                                class="flex flex-col items-center justify-center"
                                        >
                                                <a
                                                        target={target}
                                                        href={item.src}
                                                        rel={rel}
                                                        data-astro-prefetch={isInternal ? '' : undefined}
                                                        class="w-full text-center transition-all duration-150 ease-out hover:-translate-y-1 hover:scale-110"
                                                >
                                                        {item.name}
                                                </a>
                                                <hr class="bg-goldColor h-0.5 w-full border-0" />
                                        </li>
                                );
                        })
                }
		<CoberturaMobile />
		<li class="flex flex-col items-center justify-center">
			<a
				href="/footer/PPDP.pdf"
				target="_blank"
				rel="noopener noreferrer"
				class="w-full text-center transition-all duration-150 ease-out hover:-translate-y-1 hover:scale-110"
				>Política De Datos Personales</a
			>
			<hr class="bg-goldColor h-0.5 w-full border-0" />
		</li>
	</ul>
</div>

<script type="module" is:inline>
        let cleanupHandlers = [];

        const cleanup = () => {
                cleanupHandlers.forEach((fn) => fn());
                cleanupHandlers = [];

                document.body.style.overflow = '';
                const nav = document.getElementById('navHeaderMobile');
                if (nav) {
                        nav.style.display = 'none';
                }
        };

        const setupMobileNav = () => {
                cleanup();

                const button = document.getElementById('checkboxHeader');
                const nav = document.getElementById('navHeaderMobile');

                if (!(button instanceof HTMLInputElement) || !(nav instanceof HTMLDivElement)) {
                        return;
                }

                const toggleNav = () => {
                        if (button.checked) {
                                document.body.style.overflowY = 'hidden';
                                nav.style.display = 'flex';
                        } else {
                                document.body.style.overflow = '';
                                nav.style.display = 'none';
                        }
                };

                toggleNav();
                const handler = () => toggleNav();
                button.addEventListener('change', handler);
                cleanupHandlers.push(() => button.removeEventListener('change', handler));
        };

        const readyStates = ['complete', 'interactive'];
        if (readyStates.includes(document.readyState)) {
                setupMobileNav();
        } else {
                document.addEventListener('DOMContentLoaded', setupMobileNav, { once: true });
        }

        document.addEventListener('astro:page-load', setupMobileNav);
        document.addEventListener('astro:after-swap', setupMobileNav);
        document.addEventListener('astro:before-swap', cleanup, { once: true });
        window.addEventListener('pagehide', cleanup, { once: true });

        export {};
</script>

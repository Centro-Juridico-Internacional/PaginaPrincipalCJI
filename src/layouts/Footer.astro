---
/**
 * FOOTER COMPONENT V3
 * High-end institutional design using Tailwind CSS
 * Optimized for mobile and desktop
 */
import SocialIcon from '../components/ui/SocialIcon.astro';

interface SocialMediaItem {
	name: string;
	url: string;
	icon: string;
}

const SOCIALMEDIA: SocialMediaItem[] = [
	{
		name: 'Linkedin',
		url: 'https://www.linkedin.com/company/centro-juridico-internacional-s-a-s-/',
		icon: '/footer/in.svg'
	},
	{
		name: 'Facebook',
		url: 'https://www.facebook.com/CentroJuridicoInternacional/',
		icon: '/footer/fb.svg'
	},
	{
		name: 'YouTube',
		url: 'https://youtube.com/channel/UCUMJo4IlIG8bETW-OhoNNkg?si=OoXPD1Q6Iv4cNAk2',
		icon: '/footer/yt.svg'
	},
	{
		name: 'Instagram',
		url: 'https://www.instagram.com/centrojuridicosas?igsh=MXZiemR3N3JrcnYzbA%3D%3D&utm_source=qr',
		icon: '/footer/ig.svg'
	},
	{
		name: 'TikTok',
		url: 'https://www.tiktok.com/@centrojuridicosas?_t=ZS-8uImpyrWTCc&_r=1',
		icon: '/footer/tiktok.svg'
	}
];

const LOCATIONS = [
	{
		id: 'Bogota',
		city: 'Bogot√°',
		name: 'Sede Principal',
		address: 'Carrera 24 No. 27 a 21',
		mapUrl: 'https://maps.app.goo.gl/9hVc2UAe7Wyuq7eV9',
		tels: ['601 241 51 00', '601 626 50 41'],
		cels: ['312 490 21 43', '300 218 32 46'],
		email: 'consulta@centrojuridicointernacional.com',
		flag: '/footer/col.svg'
	},
	{
		id: 'Villavicencio',
		city: 'Villavicencio',
		name: 'Sede Regional',
		address: 'Calle 15 # 40 - 01 - C.C. Primavera Urbana - Of. 635',
		mapUrl: 'https://maps.app.goo.gl/da2ug4j4frULwEXFA',
		tels: ['608 678 39 15'],
		cels: ['317 646 77 53', '314 203 34 97']
	},
	{
		id: 'Ibague',
		city: 'Ibagu√©',
		name: 'Sede Regional',
		address: 'Carrara 6 No. 53-54 - Ed. Torreon - Of. 801',
		mapUrl: 'https://maps.app.goo.gl/88FCDmD3sRTmgn1m9',
		tels: ['608 276 18 05'],
		cels: ['317 471 90 18', '317 479 82 05']
	},
	{
		id: 'Tunja',
		city: 'Tunja',
		name: 'Sede Regional',
		address: 'Carrera 1F #40 - 149 - Ed. Marca Torre 2 - Of. 518',
		mapUrl: 'https://maps.app.goo.gl/PeRCeMW8TuKQMJMn9',
		tels: ['608 740 19 66'],
		cels: ['316 025 44 62', '310 518 23 20']
	},
	{
		id: 'Chia',
		city: 'Ch√≠a',
		name: 'Sede Regional',
		address: 'Km. 1.5 via Ch√≠a-Cajic√° - OXus Centro Empresarial - Of. 308',
		mapUrl: 'https://maps.app.goo.gl/Hafmhcwfy7x9GtEu6',
		tels: ['601 863 01 31'],
		cels: ['310 518 23 47', '317 513 24 62']
	},
	{
		id: 'USA',
		city: 'Miami',
		name: 'Contacto Internacional',
		address: '1395 Brickel AVE, 8TH FLOOR, MIAMI, FL 33131',
		mapUrl: 'https://maps.google.com/?q=1395+Brickell+Ave+Miami+FL+33131',
		tels: [],
		cels: [],
		flag: '/footer/usa.svg'
	}
];

interface Props {
	showContactCards?: boolean;
	hideLocations?: string[]; // IDs of locations to hide (e.g., ['USA'])
	locationOverrides?: Record<string, { tels?: string[]; cels?: string[] }>; // Add extra numbers or replace
}

const { 
  showContactCards = true, 
  hideLocations = [], 
  locationOverrides = {} 
} = Astro.props || {};

// Sanitize props to ensure they are arrays/objects even if passed as null
const safeHideLocations = Array.isArray(hideLocations) ? hideLocations : [];
const safeLocationOverrides = (locationOverrides && typeof locationOverrides === 'object') ? locationOverrides : {};

// Process locations with overrides
const FINAL_LOCATIONS = LOCATIONS.filter((loc) => !safeHideLocations.includes(loc.id)).map((loc) => {
	if (safeLocationOverrides[loc.id]) {
		return {
			...loc,
			tels: [...(loc.tels || []), ...(safeLocationOverrides[loc.id].tels || [])],
			cels: [...(loc.cels || []), ...(safeLocationOverrides[loc.id].cels || [])]
		};
	}
	return loc;
});
---

<footer
	class="w-full overflow-hidden border-t border-white/5 bg-[#042501] py-12 font-sans text-gray-300 md:py-20"
>
	<div class="mx-auto max-w-[1400px] px-6 md:px-8">
		<!-- Top Section -->
		<div
			class="mb-12 flex flex-col items-start justify-between gap-10 border-b border-white/10 pb-12 lg:flex-row lg:items-center"
		>
			<div class="relative -ml-6 flex w-screen flex-col gap-4 md:ml-0 md:w-[50%]">
				<img
					src="/footer/logo.svg"
					alt="Centro Jur√≠dico Internacional"
					class="h-auto w-full self-start md:w-auto"
				/>
				<p class="ml-4 text-lg font-medium text-[#c5a059] italic md:ml-0 md:text-xl">
					Excelencia Jur√≠dica sin fronteras.
				</p>
			</div>

			{showContactCards && (
				<div class="flex w-full flex-col gap-6 md:flex-row lg:w-[50%]">
					<!-- Contact Card 1 -->
					<div
						class="flex min-w-[300px] flex-1 items-center gap-4 rounded-2xl border border-white/10 bg-white/5 p-5"
					>
						<div
							class="flex h-12 w-12 items-center justify-center rounded-xl bg-[#c5a059]/10 text-2xl text-[#c5a059]"
						>
							‚úâ
						</div>
						<div class="flex flex-col overflow-hidden">
							<span class="mb-0.5 text-[10px] tracking-widest text-gray-500 uppercase sm:text-xs"
								>Email Consultas</span
							>
							<a
								href="mailto:consulta@centrojuridicointernacional.com"
								class="truncate text-sm font-bold text-white transition-colors hover:text-[#c5a059] sm:text-base"
								>consulta@centrojuridicointernacional.com</a
							>
						</div>
					</div>
					<!-- Contact Card 2 -->
					<div
						class="flex min-w-[240px] flex-1 items-center gap-4 rounded-2xl border border-white/10 bg-white/5 p-5"
					>
						<div
							class="flex h-12 w-12 items-center justify-center rounded-xl bg-[#c5a059]/10 text-2xl text-[#c5a059]"
						>
							üìû
						</div>
						<div class="flex flex-col">
							<span class="mb-0.5 text-[10px] tracking-widest text-gray-500 uppercase sm:text-xs"
								>L√≠nea Nacional</span
							>
							<a
								href="tel:+576012415100"
								class="text-sm font-bold text-white transition-colors hover:text-[#c5a059] sm:text-base"
								>+57 (601) 241 51 00</a
							>
						</div>
					</div>
				</div>
			)}
		</div>

		<!-- Locations Grid -->
		<div
			class="mb-16 grid grid-cols-1 gap-x-8 gap-y-12 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6"
		>
			{
				FINAL_LOCATIONS.map((loc) => (
					<div class="flex flex-col gap-4" id={loc.id}>
						<h4 class="flex items-center justify-between border-b-2 border-[#c5a059]/30 pb-3 text-xs font-black tracking-[0.2em] text-white uppercase md:text-[13px]">
							{loc.city}
							{loc.flag && (
								<img src={loc.flag} alt={`${loc.city} flag`} class="h-4 w-auto drop-shadow-sm" />
							)}
						</h4>
						<div class="flex flex-col gap-4">
							<div class="flex flex-col gap-1">
								<span class="text-[10px] font-bold tracking-widest text-[#c5a059] uppercase">
									{loc.name}
								</span>
								<a
									href={loc.mapUrl}
									target="_blank"
									rel="noopener noreferrer"
									class="inline-block text-sm leading-relaxed text-gray-200 transition-all hover:translate-x-1 hover:text-white"
								>
									{loc.address}
								</a>
							</div>

							{(loc.tels.length > 0 || loc.cels.length > 0) && (
								<div class="flex flex-col gap-2 rounded-lg border border-white/5 bg-white/5 p-3">
									{loc.tels.map((t) => (
										<div class="flex items-center gap-2 text-xs">
											<span class="font-bold text-[#c5a059]">Tel√©fono.</span>
											<span class="font-medium text-gray-400">{t}</span>
										</div>
									))}
									{loc.cels.map((c) => (
										<div class="flex items-center gap-2 text-xs">
											<span class="font-bold text-[#c5a059]">Celular.</span>
											<span class="font-medium text-gray-400">{c}</span>
										</div>
									))}
								</div>
							)}
						</div>
					</div>
				))
			}
		</div>

		<!-- Bottom Section -->
		<div
			class="flex flex-col items-center justify-between gap-12 border-t border-white/10 pt-10 pb-[6dvh] lg:flex-row"
		>
			<!-- Social & Legal -->
			<div class="flex w-full flex-col items-center gap-8 sm:flex-row lg:w-auto">
				<div class="flex gap-4">
					{
						SOCIALMEDIA.map((social) => (
							<a
								href={social.url}
								target="_blank"
								rel="noopener noreferrer"
								class="group flex h-11 w-11 items-center justify-center rounded-xl border border-white/10 bg-white/5 shadow-lg transition-all duration-300 hover:-translate-y-1 hover:bg-[#c5a059]"
								aria-label={social.name}
							>
								<SocialIcon name={social.name} class="text-gray-400 group-hover:text-black" />
							</a>
						))
					}
				</div>
				<div class="hidden h-10 w-[1px] bg-white/10 sm:block"></div>
				<div class="text-center sm:text-left">
					<p class="mb-1 text-xs font-black tracking-widest text-white uppercase">
						Protecci√≥n de Datos
					</p>
					<a
						href="/footer/PPDP.pdf"
						target="_blank"
						class="text-sm text-[#c5a059] underline decoration-[#c5a059]/30 underline-offset-4 transition-colors hover:text-white"
						>Ver pol√≠tica de privacidad</a
					>
				</div>
			</div>

			<!-- Copyright -->
			<div class="text-center lg:mt-0 lg:text-right">
				<p class="text-sm font-medium tracking-wide text-gray-500">
					¬© {new Date().getFullYear()} Centro Jur√≠dico Internacional. <br class="sm:hidden" />
					<span class="hidden sm:inline">|</span> Todos los derechos reservados.
				</p>
			</div>
		</div>
	</div>
</footer>
